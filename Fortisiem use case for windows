### how to find the logon related logs in fortisiem for windows machine ###
reporting ip = ip_add AND Event Type IN Win-Security-4624 
reporting ip = ip_add AND Event Type IN Win-Security-4625
reporting ip = ip_add AND Event Type IN Win-Security-4625 AND Raw Event Log CONTAIN remote    ### for remote logon failure. ###



### executing malicious code in remote machine with PsExec(Sysinternal) ###
psexec \\destination_ip_address -u domain\username -p password calc
psexec \\destination_ip_address -u domain\username -p password cmd      ### executing cmd.exe in remote machine
psexec \\destination_ip_address -u domain\username -p password powershell     ### executing powershell.exe remote machine


@@@ detecing in fortisiem @@@
reporting ip = ip_address AND Event Type IN Win-Sysmon-1-Create-Process AND Raw Event Log CONTAIN psexec   
reporting ip = ip_address AND Event Type = FINS-Windows-new-process-created AND Process Name IN psexec.exe ### this one for ueba related rule trigger i.e. detecting hacking tools usage. ###

### installing software on remote machine with psexec
psexec \\remote_machine -u domain\user -p Password -i -s msiexec.exe /i "C:\Users\Administrator\Downloads\Firefox Setup 87.0.msi" /qn /norestart 

## this above command end with msiexec.exe exited on 192.168.124.230 with error code 0 ## this only work with .msi setup file in windows. 

reporting ip = ip_address AND Event Type IN Win-Sysmon-1-Create-Process AND Raw Event Log CONTAIN psexec      ### for detection of installing software remotely with psexec ###


### how to detect software installation by a watched user through UEBA in fortisiem analytics. ###
Event Type = FINS-Windows-new-process-created AND Process Name REGEXP .*(install|msiexec|setup|update).*\.exe AND Raw Event Log CONTAIN App_installer_name.

### how to detect hacking tools(nmap) usage by watched user(ueba engine) in fortisiem analytics ###
Event Type = FINS-Windows-new-process-created AND Process Name IN nmap, nmap.exe, zenmap, zenmap.exe 


### how to restart fortisightagent(For UEBA telemetry) in supervisor. ###
systemctl restart phFortiInsightAI
phstatus

